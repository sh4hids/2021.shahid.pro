{"componentChunkName":"component---node-modules-sh-4-hids-gatsby-theme-open-sourcerer-src-templates-post-js","path":"/blog/2023/02/20/release-electron-app-to-github-using-semantic-release-and-electron-builder/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://v2021.shahid.pro","blogPath":"blog","baseEditUrl":"https://github.com/sh4hids/2021.shahid.pro/edit/main/contents/blog","utterancesCommentRepo":"sh4hids/shahid.pro-comments","author":{"fullName":"Shahidul Islam Majumder"}}},"markdownRemark":{"html":"<p>I have been working on a personal desktop project (<a href=\"https://github.com/deskaide/deskaide\">Deskaide</a>) for about one year and finished some basic features recently. So I decided to publish an alpha version to GitHub. Instead of upgrading the version number and publishing it manually, I was looking for a way to automate the process.</p>\n<p>The template I was following to structure the project uses electron builder to build the project. It uses the current date as the upcoming version number. It seems okay, but the version number does not indicate what type of changes it includes. I believe <a href=\"https://github.com/semantic-release/semantic-release\">semantic-release</a> has the solution, and I used it in some of my other projects.</p>\n<p>I started exploring a solution. I found an <a href=\"https://github.com/mystster/semantic-release-github-electron-builder\">electron release plugin</a> for the semantic release package but found it complicated. I decided to hack the semantic release process and use it only to update the version number (it can publish) and push the tag to GitHub. Electron builder can publish the release to GitHub, so I don't need any extra hacking to publish the release. The process looks like this:</p>\n<ul>\n<li>Configure semantic release</li>\n<li>Prepare the npm script</li>\n<li>Configure GitHub action</li>\n</ul>\n<p>Let's explore the process in detail.</p>\n<h2 id=\"configure-semantic-release\" style=\"position:relative;\"><a href=\"#configure-semantic-release\" aria-label=\"configure semantic release permalink\" class=\"header-anchor-icon before\"><svg version=\"1.1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 162.656 162.656\" xml:space=\"preserve\" width=\"0.6em\" height=\"0.6em\" fill=\"#21AAE2\" stroke=\"#21AAE2\" stroke-width=\"0\"><path d=\"M151.764,10.894c-14.522-14.522-38.152-14.525-52.676-0.008l0.003,0.003L76.112,33.872l10.607,10.605l22.983-22.988 l-0.002-0.002c8.678-8.663,22.785-8.658,31.457,0.014c8.673,8.672,8.672,22.786,0,31.461l-34.486,34.484 c-4.201,4.202-9.787,6.516-15.729,6.516c-5.942,0-11.529-2.314-15.73-6.516L64.605,98.052c7.035,7.035,16.389,10.91,26.338,10.91 c9.949,0,19.303-3.875,26.335-10.91l34.487-34.484C166.284,49.043,166.284,25.413,151.764,10.894z\"></path> <path d=\"M52.96,141.162L52.96,141.162c-8.675,8.67-22.788,8.668-31.461-0.005c-8.673-8.675-8.673-22.791-0.001-31.465L55.98,75.21 c8.675-8.674,22.789-8.674,31.462,0L98.05,64.604c-14.524-14.523-38.154-14.524-52.676,0L10.89,99.086 c-14.519,14.523-14.519,38.154,0.001,52.678c7.263,7.262,16.801,10.893,26.341,10.892c9.536,0,19.074-3.629,26.333-10.887 l0.002-0.001l22.984-22.99l-10.608-10.606L52.96,141.162z\"></path> </svg></a>Configure semantic release</h2>\n<p>First, we will install <code class=\"language-text\">semantic-release</code> as a dev dependency with other related plugins.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> i <span class=\"token parameter variable\">-D</span> semantic-release @semantic-release/commit-analyzer @semantic-release/npm @semantic-release/git semantic-release-export-data</code></pre></div>\n<p>Now we need to configure it in such a way that it will calculate the upcoming version number from the commit message and expose it to the GitHub workflow environment. We need to add the following code in a file named <code class=\"language-text\">release.config.js</code> at the root of our project folder.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">branches</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'main'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'next'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'next-major'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'beta'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">prerelease</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'alpha'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">prerelease</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'@semantic-release/commit-analyzer'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'semantic-release-export-data'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'@semantic-release/npm'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">'@semantic-release/git'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">assets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'package.json'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'package-lock.json'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Here <a href=\"https://github.com/felipecrs/semantic-release-export-data\">semantic-release-export-data</a> plugin will help us to expose the next release version to the GitHub\naction environment. We will use that version number to name our releases in the build step.</p>\n<h2 id=\"prepare-the-npm-script\" style=\"position:relative;\"><a href=\"#prepare-the-npm-script\" aria-label=\"prepare the npm script permalink\" class=\"header-anchor-icon before\"><svg version=\"1.1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 162.656 162.656\" xml:space=\"preserve\" width=\"0.6em\" height=\"0.6em\" fill=\"#21AAE2\" stroke=\"#21AAE2\" stroke-width=\"0\"><path d=\"M151.764,10.894c-14.522-14.522-38.152-14.525-52.676-0.008l0.003,0.003L76.112,33.872l10.607,10.605l22.983-22.988 l-0.002-0.002c8.678-8.663,22.785-8.658,31.457,0.014c8.673,8.672,8.672,22.786,0,31.461l-34.486,34.484 c-4.201,4.202-9.787,6.516-15.729,6.516c-5.942,0-11.529-2.314-15.73-6.516L64.605,98.052c7.035,7.035,16.389,10.91,26.338,10.91 c9.949,0,19.303-3.875,26.335-10.91l34.487-34.484C166.284,49.043,166.284,25.413,151.764,10.894z\"></path> <path d=\"M52.96,141.162L52.96,141.162c-8.675,8.67-22.788,8.668-31.461-0.005c-8.673-8.675-8.673-22.791-0.001-31.465L55.98,75.21 c8.675-8.674,22.789-8.674,31.462,0L98.05,64.604c-14.524-14.523-38.154-14.524-52.676,0L10.89,99.086 c-14.519,14.523-14.519,38.154,0.001,52.678c7.263,7.262,16.801,10.893,26.341,10.892c9.536,0,19.074-3.629,26.333-10.887 l0.002-0.001l22.984-22.99l-10.608-10.606L52.96,141.162z\"></path> </svg></a>Prepare the npm script</h2>\n<p>We need an npm script to run the <code class=\"language-text\">semantic-release</code> command. In our <code class=\"language-text\">package.json</code> in the scripts section, we will add the following commands:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"release\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"electron-builder --config .electron-builder.config.js --publish always\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"updateVersion\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"semantic-release\"</span></code></pre></div>\n<p>In the <code class=\"language-text\">release</code> script, we added <code class=\"language-text\">--publish always</code> to tell electron builder to publish it to GitHub.</p>\n<h2 id=\"configure-github-action\" style=\"position:relative;\"><a href=\"#configure-github-action\" aria-label=\"configure github action permalink\" class=\"header-anchor-icon before\"><svg version=\"1.1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 162.656 162.656\" xml:space=\"preserve\" width=\"0.6em\" height=\"0.6em\" fill=\"#21AAE2\" stroke=\"#21AAE2\" stroke-width=\"0\"><path d=\"M151.764,10.894c-14.522-14.522-38.152-14.525-52.676-0.008l0.003,0.003L76.112,33.872l10.607,10.605l22.983-22.988 l-0.002-0.002c8.678-8.663,22.785-8.658,31.457,0.014c8.673,8.672,8.672,22.786,0,31.461l-34.486,34.484 c-4.201,4.202-9.787,6.516-15.729,6.516c-5.942,0-11.529-2.314-15.73-6.516L64.605,98.052c7.035,7.035,16.389,10.91,26.338,10.91 c9.949,0,19.303-3.875,26.335-10.91l34.487-34.484C166.284,49.043,166.284,25.413,151.764,10.894z\"></path> <path d=\"M52.96,141.162L52.96,141.162c-8.675,8.67-22.788,8.668-31.461-0.005c-8.673-8.675-8.673-22.791-0.001-31.465L55.98,75.21 c8.675-8.674,22.789-8.674,31.462,0L98.05,64.604c-14.524-14.523-38.154-14.524-52.676,0L10.89,99.086 c-14.519,14.523-14.519,38.154,0.001,52.678c7.263,7.262,16.801,10.893,26.341,10.892c9.536,0,19.074-3.629,26.333-10.887 l0.002-0.001l22.984-22.99l-10.608-10.606L52.96,141.162z\"></path> </svg></a>Configure GitHub action</h2>\n<p>Now we will configure our GitHub workflow to combine all the steps.</p>\n<ul>\n<li>First, we will set up a job to run semantic-release in dry mode to expose  the upcoming version number (if releasable) to the GitHub action environment (job name <code class=\"language-text\">get-next-version</code>)</li>\n<li>Then, we will  create a release draft with a release note (job name <code class=\"language-text\">draft</code>)</li>\n<li>Finally, we will build the production release and upload the artifacts to GitHub (job name <code class=\"language-text\">upload_artifacts</code>).</li>\n</ul>\n<p>Before building the production release, we will run the <code class=\"language-text\">updateVersion</code> script we defined earlier. It will generate the upcoming version number and tag and push the version tag to GitHub. Then we will put the version number in a file named <code class=\"language-text\">meta.json</code> inside our <code class=\"language-text\">buildResources</code> folder at the root of our project. Finally, we will build our project for production and run the <code class=\"language-text\">release</code> script to release the app to GitHub. Following is the complete workflow configuration:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Release A New Version\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>workflow_call<span class=\"token punctuation\">,</span> workflow_dispatch<span class=\"token punctuation\">]</span>\n\n<span class=\"token key atrule\">concurrency</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">group</span><span class=\"token punctuation\">:</span> release<span class=\"token punctuation\">-</span>$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.ref <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">cancel-in-progress</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n<span class=\"token key atrule\">defaults</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'bash'</span>\n<span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">GH_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.github_token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">get-next-version</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">16</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm ci\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npx semantic<span class=\"token punctuation\">-</span>release <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>dry<span class=\"token punctuation\">-</span>run\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> get<span class=\"token punctuation\">-</span>next<span class=\"token punctuation\">-</span>version\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.github_token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">outputs</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">new-release-published</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.get<span class=\"token punctuation\">-</span>next<span class=\"token punctuation\">-</span>version.outputs.new<span class=\"token punctuation\">-</span>release<span class=\"token punctuation\">-</span>published <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">new-release-version</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.get<span class=\"token punctuation\">-</span>next<span class=\"token punctuation\">-</span>version.outputs.new<span class=\"token punctuation\">-</span>release<span class=\"token punctuation\">-</span>version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token key atrule\">draft</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">needs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">-</span>next<span class=\"token punctuation\">-</span>version<span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> needs.get<span class=\"token punctuation\">-</span>next<span class=\"token punctuation\">-</span>version.outputs.new<span class=\"token punctuation\">-</span>release<span class=\"token punctuation\">-</span>published == 'true'\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">fetch-depth</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">16</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Show version\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"Next Version is $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> needs.get<span class=\"token punctuation\">-</span>next<span class=\"token punctuation\">-</span>version.outputs.new<span class=\"token punctuation\">-</span>release<span class=\"token punctuation\">-</span>version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> ($<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.ref_name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>)\"\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Get last git tag\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> tag\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"last<span class=\"token punctuation\">-</span>tag=$(git describe <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>tags <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>abbrev=0 <span class=\"token punctuation\">|</span><span class=\"token punctuation\">|</span> git rev<span class=\"token punctuation\">-</span>list <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>max<span class=\"token punctuation\">-</span>parents=0 $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>github.ref<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>)\" <span class=\"token punctuation\">></span><span class=\"token punctuation\">></span> $GITHUB_OUTPUT\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Generate release notes\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> ./.github/actions/release<span class=\"token punctuation\">-</span>notes\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> release<span class=\"token punctuation\">-</span>note\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">from</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.tag.outputs.last<span class=\"token punctuation\">-</span>tag <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">to</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.ref <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">include-commit-body</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n          <span class=\"token key atrule\">include-abbreviated-commit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Delete outdated drafts\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> hugo19941994/delete<span class=\"token punctuation\">-</span>draft<span class=\"token punctuation\">-</span>releases@v1.0.0\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.GITHUB_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Create Release Draft\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> softprops/action<span class=\"token punctuation\">-</span>gh<span class=\"token punctuation\">-</span>release@v1\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.github_token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">prerelease</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n          <span class=\"token key atrule\">draft</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n          <span class=\"token key atrule\">tag_name</span><span class=\"token punctuation\">:</span> v$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> needs.get<span class=\"token punctuation\">-</span>next<span class=\"token punctuation\">-</span>version.outputs.new<span class=\"token punctuation\">-</span>release<span class=\"token punctuation\">-</span>version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> v$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> needs.get<span class=\"token punctuation\">-</span>next<span class=\"token punctuation\">-</span>version.outputs.new<span class=\"token punctuation\">-</span>release<span class=\"token punctuation\">-</span>version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">body</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.release<span class=\"token punctuation\">-</span>note.outputs.release<span class=\"token punctuation\">-</span>note <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">outputs</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">release-note</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.release<span class=\"token punctuation\">-</span>note.outputs.release<span class=\"token punctuation\">-</span>note <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> needs.get<span class=\"token punctuation\">-</span>next<span class=\"token punctuation\">-</span>version.outputs.new<span class=\"token punctuation\">-</span>release<span class=\"token punctuation\">-</span>version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token key atrule\">upload_artifacts</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">needs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>draft<span class=\"token punctuation\">]</span>\n\n    <span class=\"token key atrule\">strategy</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">matrix</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">os</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>macos<span class=\"token punctuation\">-</span>latest<span class=\"token punctuation\">,</span> ubuntu<span class=\"token punctuation\">-</span>latest<span class=\"token punctuation\">,</span> windows<span class=\"token punctuation\">-</span>latest<span class=\"token punctuation\">]</span>\n\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> matrix.os <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">16</span>\n          <span class=\"token key atrule\">cache</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'npm'</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm ci\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Prepare release notes\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">RELEASE_NOTE</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> needs.draft.outputs.release<span class=\"token punctuation\">-</span>note <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"$RELEASE_NOTE\" <span class=\"token punctuation\">></span><span class=\"token punctuation\">></span> ./buildResources/release<span class=\"token punctuation\">-</span>notes.md\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Show version\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"Next Version is $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> needs.draft.outputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> ($<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.ref_name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>)\"\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Update and push version tag\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run updateVersion\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Write next version to meta.json\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"<span class=\"token punctuation\">{</span>\\\"version\\\"<span class=\"token punctuation\">:</span>\\\"$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> needs.draft.outputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\\\"<span class=\"token punctuation\">}</span>\" <span class=\"token punctuation\">></span><span class=\"token punctuation\">|</span> ./buildResources/meta.json\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build the app\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">MODE</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'production'</span>\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run build\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Compile &amp; release Electron app\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> release<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>github\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">VITE_APP_VERSION</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> needs.draft.outputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run release\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Delete tag for failed release\n        <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> steps.release<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>github.outcome == 'failure'\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> git push <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>delete origin v$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> needs.draft.outputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>```</code></pre></div>\n<p>If you want to see the complete process in action or want to contribute to the open source <code class=\"language-text\">Deskaide</code> project, please check out the <a href=\"https://github.com/deskaide/deskaide\">repository</a> here.</p>\n<h2 id=\"hard-lesson\" style=\"position:relative;\"><a href=\"#hard-lesson\" aria-label=\"hard lesson permalink\" class=\"header-anchor-icon before\"><svg version=\"1.1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 162.656 162.656\" xml:space=\"preserve\" width=\"0.6em\" height=\"0.6em\" fill=\"#21AAE2\" stroke=\"#21AAE2\" stroke-width=\"0\"><path d=\"M151.764,10.894c-14.522-14.522-38.152-14.525-52.676-0.008l0.003,0.003L76.112,33.872l10.607,10.605l22.983-22.988 l-0.002-0.002c8.678-8.663,22.785-8.658,31.457,0.014c8.673,8.672,8.672,22.786,0,31.461l-34.486,34.484 c-4.201,4.202-9.787,6.516-15.729,6.516c-5.942,0-11.529-2.314-15.73-6.516L64.605,98.052c7.035,7.035,16.389,10.91,26.338,10.91 c9.949,0,19.303-3.875,26.335-10.91l34.487-34.484C166.284,49.043,166.284,25.413,151.764,10.894z\"></path> <path d=\"M52.96,141.162L52.96,141.162c-8.675,8.67-22.788,8.668-31.461-0.005c-8.673-8.675-8.673-22.791-0.001-31.465L55.98,75.21 c8.675-8.674,22.789-8.674,31.462,0L98.05,64.604c-14.524-14.523-38.154-14.524-52.676,0L10.89,99.086 c-14.519,14.523-14.519,38.154,0.001,52.678c7.263,7.262,16.801,10.893,26.341,10.892c9.536,0,19.074-3.629,26.333-10.887 l0.002-0.001l22.984-22.99l-10.608-10.606L52.96,141.162z\"></path> </svg></a>Hard Lesson</h2>\n<blockquote>\n<p>If you use modular GitHub workflows (different jobs in different files) and any lower-level actions need to access any secret value, you must tell the root workflow to pass the secret value to that action.</p>\n</blockquote>\n<p>In my <code class=\"language-text\">ci.yaml</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># This workflow is the entry point for all CI processes.</span>\n<span class=\"token comment\"># It is from here that all other workflows launch.</span>\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> main\n      <span class=\"token punctuation\">-</span> alpha\n      <span class=\"token punctuation\">-</span> beta\n    <span class=\"token key atrule\">paths-ignore</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">'**.md'</span>\n      <span class=\"token punctuation\">-</span> .editorconfig\n      <span class=\"token punctuation\">-</span> .gitignore\n  <span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">paths-ignore</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">'**.md'</span>\n      <span class=\"token punctuation\">-</span> .editorconfig\n      <span class=\"token punctuation\">-</span> .gitignore\n\n<span class=\"token key atrule\">concurrency</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">group</span><span class=\"token punctuation\">:</span> ci<span class=\"token punctuation\">-</span>$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.ref <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">cancel-in-progress</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">lint</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> ./.github/workflows/lint.yml\n  <span class=\"token key atrule\">typechecking</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> ./.github/workflows/typechecking.yml\n  <span class=\"token key atrule\">tests</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> ./.github/workflows/tests.yml\n  <span class=\"token key atrule\">draft_release</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> github.event_name == 'push' <span class=\"token important\">&amp;&amp;</span> (github.ref_name == 'alpha' <span class=\"token punctuation\">|</span><span class=\"token punctuation\">|</span> github.ref_name == 'beta' <span class=\"token punctuation\">|</span><span class=\"token punctuation\">|</span> github.ref_name == 'main')\n    <span class=\"token key atrule\">needs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>typechecking<span class=\"token punctuation\">,</span> tests<span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> ./.github/workflows/release.yml\n    <span class=\"token key atrule\">secrets</span><span class=\"token punctuation\">:</span> inherit <span class=\"token comment\"># &lt;- THIS IS WHAT I AM TALKING ABOUT</span></code></pre></div>\n<p>Thanks a lot for reading the post, and please share if you find it useful.</p>","timeToRead":5,"excerpt":"I have been working on a personal desktop project (Deskaide) for about one year and finished some basic features recently. So I decided to…","frontmatter":{"title":"Release Electron App To GitHub Using Semantic Release And Electron Builder","publishedAt":"2023-02-20","tags":["electronjs","react","vite","electron builder"],"slug":"release-electron-app-to-github-using-semantic-release-and-electron-builder"},"fields":{"slug":"/2023/02/20/release-electron-app-to-github-using-semantic-release-and-electron-builder/"}}},"pageContext":{"slug":"/2023/02/20/release-electron-app-to-github-using-semantic-release-and-electron-builder/","prev":{"frontmatter":{"tags":["node","aws","aws lambda","aws sqs"],"title":"Testing AWS Lambda and SQS locally with Node.js"},"fields":{"slug":"/2019/11/15/testing-aws-lambda-and-sqs-locally-with-nodejs/"}},"next":{"frontmatter":{"tags":["gatsby","theme","portfolio"],"title":"Published My First Gatsby Theme"},"fields":{"slug":"/2021/08/24/published-my-first-gatsby-theme/"}}}},"staticQueryHashes":["1066969672","1349029593","2767800352","3803536959","3825412538","3941996707","4259536812"]}